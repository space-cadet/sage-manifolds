








<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Jupyter Notebook Viewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">
  
  <meta name="robots" content="noindex,nofollow">
  

  <!--NEW RELIC Start Perf Measurement-->
  
  <!--NREND-->

  <!-- Le styles -->
  <script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"abd1269b22bee152eab75bba2e8d4c35",petok:"46fd12b87b12c2b907cffab2cf5b93e632352ddc-1491587369-3600",zone:"jupyter.org",rocket:"0",apps:{"ga_key":{"ua":"UA-52617120-1","ga_bs":"2"}}}];!function(a,b){a=document.createElement("script"),b=document.getElementsByTagName("script")[0],a.async=!0,a.src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=f2befc48d1/cloudflare.min.js",b.parentNode.insertBefore(a,b)}()}}catch(e){};
//]]>
</script>
<link href="/static/build/styles.css?v=c18d49652a516277e15114bbd447f1c1" rel="stylesheet">

  <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- Le fav and touch icons -->
  <link rel="shortcut icon" href="/static/ico/ipynb_icon_16x16.png">
  <link rel="apple-touch-icon-precomposed" sizes="144x144"
        href="/static/ico/apple-touch-icon-144-precomposed.png?v=5a3c9ede93e2a8b8ea9e3f8f3da1a905">
  <link rel="apple-touch-icon-precomposed" sizes="114x114"
        href="/static/ico/apple-touch-icon-114-precomposed.png?v=45d86fc8f24dc00638035e1dd7a6d898">
  <link rel="apple-touch-icon-precomposed" sizes="72x72"
        href="/static/ico/apple-touch-icon-72-precomposed.png?v=540b5eb0f3cfd25f1439d1c9bd30e15f">
  <link rel="apple-touch-icon-precomposed"
        href="/static/ico/apple-touch-icon-57-precomposed.png?v=225f0590e187e1458625654f10a28f56">
  
  

  

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Notebook on nbviewer">
  <meta name="twitter:description" content="Check out this Jupyter notebook!">

  
  <meta name="twitter:domain" content="nbviewer.ipython.org">
  <meta name="twitter:image:src" content="http://ipython.org/ipython-doc/dev/_images/ipynb_icon_128x128.png">

  
    <link href="/static/build/notebook.css?v=d05748bef7d8f0edbc1e0133b9a41fe0" rel="stylesheet">
  

  

  
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript">
    </script>
    <script type="text/javascript">
      init_mathjax = function() {
        if (window.MathJax) {
          // MathJax loaded
          MathJax.Hub.Config({
            TeX: {
              equationNumbers: {
                autoNumber: "AMS",
                useLabelIds: true
              }
            },
            tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"] ],
              displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
              processEscapes: true,
              processEnvironments: true
            },
            displayAlign: 'center',
            "HTML-CSS": {
              styles: {'.MathJax_Display': {"margin": 0}},
              linebreaks: { automatic: true }
            }
          });
          MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
      }
      init_mathjax();
    </script>
  

<script type="text/javascript">
/* <![CDATA[ */
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-52617120-1']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

(function(b){(function(a){"__CF"in b&&"DJS"in b.__CF?b.__CF.DJS.push(a):"addEventListener"in b?b.addEventListener("load",a,!1):b.attachEvent("onload",a)})(function(){"FB"in b&&"Event"in FB&&"subscribe"in FB.Event&&(FB.Event.subscribe("edge.create",function(a){_gaq.push(["_trackSocial","facebook","like",a])}),FB.Event.subscribe("edge.remove",function(a){_gaq.push(["_trackSocial","facebook","unlike",a])}),FB.Event.subscribe("message.send",function(a){_gaq.push(["_trackSocial","facebook","send",a])}));"twttr"in b&&"events"in twttr&&"bind"in twttr.events&&twttr.events.bind("tweet",function(a){if(a){var b;if(a.target&&a.target.nodeName=="IFRAME")a:{if(a=a.target.src){a=a.split("#")[0].match(/[^?=&]+=([^&]*)?/g);b=0;for(var c;c=a[b];++b)if(c.indexOf("url")===0){b=unescape(c.split("=")[1]);break a}}b=void 0}_gaq.push(["_trackSocial","twitter","tweet",b])}})})})(window);
/* ]]> */
</script>
</head>

<body class="nbviewer">

  <!-- These are loaded at the top of the body so they are available to
       notebook cells when they are loaded below. -->
  <script src="/static/components/jquery/dist/jquery.min.js?v=e071abda8fe61194711cfc2ab99fe104"></script>
  <script src="/static/components/requirejs/require.js?v=6da8be361b9ee26c5e721e76c6d4afce"></script>
  <script src="/static/components/moment/min/moment.min.js?v=89f87298ad94aa1e6b92f42eb66da043"></script>

<!-- Navbar
================================================== -->
  <nav id="menubar" class="navbar navbar-default navbar-fixed-top" data-spy="affix">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <i class="fa fa-bars"></i>
        </button>
        <a class="navbar-brand" href="/">
          <img src="/static/img/nav_logo.svg?v=479cefe8d932fb14a67b93911b97d70f" width="159"/>
        </a>
      </div>

      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a class="active" href="http://jupyter.org">JUPYTER</a>
          </li>
          <li>
    <a href="/faq" title="FAQ" >
      
        <span>FAQ</span>
      
    </a>
  </li>

          
  
    
      
        <li>
    <a href="/format/script/github/sagemanifolds/SageManifolds/blob/master/Worksheets/v1.0/SM_Cartesian_spherical-3D.ipynb" title="View as Code" >
      <span class="fa fa-code fa-2x menu-icon"></span>
      <span class="menu-text">View as Code</span>
    </a>
  </li>
      
    
  
    
  

  
    <li>
    <a href="#" title="SageMath 7.5 Kernel" >
      <span class="fa fa-server fa-2x menu-icon"></span>
      <span class="menu-text">SageMath 7.5 Kernel</span>
    </a>
  </li>
  

  
    <li>
    <a href="https://github.com/sagemanifolds/SageManifolds/blob/master/Worksheets/v1.0/SM_Cartesian_spherical-3D.ipynb" title="View on GitHub" >
      <span class="fa fa-github fa-2x menu-icon"></span>
      <span class="menu-text">View on GitHub</span>
    </a>
  </li>
  

  <li>
    <a href="https://raw.githubusercontent.com/sagemanifolds/SageManifolds/master/Worksheets/v1.0/SM_Cartesian_spherical-3D.ipynb" title="Download Notebook" download>
      <span class="fa fa-download fa-2x menu-icon"></span>
      <span class="menu-text">Download Notebook</span>
    </a>
  </li>

        </ul>
      </div><!-- /.navbar-collapse -->
      
      
    </div>
  </nav>

  <div class="container container-main">
    
  
  <ol class="breadcrumb">
    
      <li>
        <a href="/github/sagemanifolds/SageManifolds/tree/master">SageManifolds</a>
      </li>
    
      <li>
        <a href="/github/sagemanifolds/SageManifolds/tree/master/Worksheets">Worksheets</a>
      </li>
    
      <li>
        <a href="/github/sagemanifolds/SageManifolds/tree/master/Worksheets/v1.0">v1.0</a>
      </li>
    
  </ol>
  
  <div id="notebook">
    <div id="notebook-container">
      
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Vector-calculus-in-Cartesian-and-spherical-coordinates">Vector calculus in Cartesian and spherical coordinates<a class="anchor-link" href="#Vector-calculus-in-Cartesian-and-spherical-coordinates">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>This worksheet illustrates some features of <a href="http://sagemanifolds.obspm.fr/">SageManifolds</a> (version 1.0, as included in SageMath 7.5) regarding vector calculus in the Euclidean 3-space by means of Cartesian and spherical coordinates.</em></p>
<p>Click <a href="https://raw.githubusercontent.com/sagemanifolds/SageManifolds/master/Worksheets/v1.0/SM_Cartesian_spherical-3D.ipynb">here</a> to download the worksheet file (ipynb format). To run it, you must start SageMath with the Jupyter notebook, via the command <code>sage -n jupyter</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>NB:</em> a version of SageMath at least equal to 7.5 is required to run this worksheet:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">version</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[1]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>&#39;SageMath version 7.5, Release Date: 2017-01-11&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Euclidean-3-space-and-Cartesian-coordinates">Euclidean 3-space and Cartesian coordinates<a class="anchor-link" href="#Euclidean-3-space-and-Cartesian-coordinates">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we set up the notebook to display mathematical objects using LaTeX formatting:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="o">%</span><span class="k">display</span> latex
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We then introduce the Euclidean space as a 3-dimensional differentiable manifold:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>3-dimensional differentiable manifold M
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We then introduce the Cartesian coordinates $(x,y,z)$ as the chart <code>cart</code> on $M$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">cart</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">cart</span><span class="p">)</span>
<span class="n">cart</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>Chart (M, (x, y, z))
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[4]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(M,(x, y, z)\right)</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Spherical-coordinates">Spherical coordinates<a class="anchor-link" href="#Spherical-coordinates">&#182;</a></h2><p>We introduce spherical coordinates $(r,\theta,\phi)$ as the chart <code>spher</code> on $M$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">spher</span><span class="o">.&lt;</span><span class="n">r</span><span class="p">,</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;r:(0,+oo) th:(0,pi):\theta ph:(0,2*pi):\phi&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">spher</span><span class="p">)</span>
<span class="n">spher</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>Chart (M, (r, th, ph))
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[5]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(M,(r, {\theta}, {\phi})\right)</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Spherical coordinates do not form a regular coordinate system of the Euclidean space. So declaring that they span $M$ means that, strictly speaking, the manifold $M$ is not the whole Euclidean space, but the Euclidean space minus some half plane (the azimuthal origin). However, in this worksheet, this difference will not matter.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The change of coordinates $(r,\theta,\phi) \rightarrow (x,y,z)$ is introduced as a transition map from chart <code>spher</code> to chart <code>cart</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">spher_to_cart</span> <span class="o">=</span> <span class="n">spher</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">cart</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span> <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span> <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)])</span>
<span class="n">spher_to_cart</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left\{\begin{array}{lcl} x & = & r \cos\left({\phi}\right) \sin\left({\theta}\right) \\ y & = & r \sin\left({\phi}\right) \sin\left({\theta}\right) \\ z & = & r \cos\left({\theta}\right) \end{array}\right.</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The inverse is also set:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">spher_to_cart</span><span class="o">.</span><span class="n">set_inverse</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span><span class="n">z</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>Check of the inverse coordinate transformation:
  r == r
  th == arctan2(r*sin(th), r*cos(th))
  ph == arctan2(r*sin(ph)*sin(th), r*cos(ph)*sin(th))
  x == x
  y == y
  z == z
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The check that the provided formulas do correspond to the inverse change of coordinates is passed, modulo some lack of simplification in some trigonometrical formulas involving the function <code>arctan2</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">cart_to_spher</span> <span class="o">=</span> <span class="n">spher_to_cart</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="n">cart_to_spher</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[8]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left\{\begin{array}{lcl} r & = & \sqrt{x^{2} + y^{2} + z^{2}} \\ {\theta} & = & \arctan\left(\sqrt{x^{2} + y^{2}}, z\right) \\ {\phi} & = & \arctan\left(y, x\right) \end{array}\right.</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The natural vector frame of spherical coordinates is</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[9]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(M, \left(\frac{\partial}{\partial r },\frac{\partial}{\partial {\theta} },\frac{\partial}{\partial {\phi} }\right)\right)</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We shall expand vector and tensor fields on the orthonormal frame $(e_1, e_2, e_3)$ associated with spherical coordinates, which is related to the natural frame $(\partial/\partial r, \partial/\partial\theta, \partial/\partial\phi)$ displayed above by means of the following field of automorphisms:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">to_orthonormal</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">automorphism_field</span><span class="p">()</span>
<span class="n">to_orthonormal</span><span class="p">[</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">spher</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">to_orthonormal</span><span class="p">[</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">spher</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">r</span>
<span class="n">to_orthonormal</span><span class="p">[</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">spher</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">))</span>
<span class="n">to_orthonormal</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[10]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{\partial}{\partial r }\otimes \mathrm{d} r + \frac{1}{r} \frac{\partial}{\partial {\theta} }\otimes \mathrm{d} {\theta} + \frac{1}{r \sin\left({\theta}\right)} \frac{\partial}{\partial {\phi} }\otimes \mathrm{d} {\phi}</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In other words, the change-of-basis matrix is</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">to_orthonormal</span><span class="p">[</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),:,</span><span class="n">spher</span><span class="p">]</span> 
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[11]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(\begin{array}{rrr}
1 & 0 & 0 \\
0 & \frac{1}{r} & 0 \\
0 & 0 & \frac{1}{r \sin\left({\theta}\right)}
\end{array}\right)</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We construct the orthonormal frame from the natural frame of spherical coordinates by this change of basis:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">es</span> <span class="o">=</span> <span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span><span class="o">.</span><span class="n">new_frame</span><span class="p">(</span><span class="n">to_orthonormal</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">es</span><span class="p">)</span>
<span class="n">es</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>Vector frame (M, (e_1,e_2,e_3))
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[12]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(M, \left(e_1,e_2,e_3\right)\right)</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">es</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[13]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}e_1 = \frac{\partial}{\partial r }</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">es</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[14]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}e_2 = \frac{1}{r} \frac{\partial}{\partial {\theta} }</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">es</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[15]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}e_3 = \frac{1}{r \sin\left({\theta}\right)} \frac{\partial}{\partial {\phi} }</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we do not specify the frame and coordinates for the display, we get it in terms of the default ones (i.e. Cartesian frame and Cartesian coordinates):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">es</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[16]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}e_1 = \left( \frac{x}{\sqrt{x^{2} + y^{2} + z^{2}}} \right) \frac{\partial}{\partial x } + \left( \frac{y}{\sqrt{x^{2} + y^{2} + z^{2}}} \right) \frac{\partial}{\partial y } + \left( \frac{z}{\sqrt{x^{2} + y^{2} + z^{2}}} \right) \frac{\partial}{\partial z }</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">es</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[17]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}e_2 = \left( \frac{x z}{\sqrt{x^{2} + y^{2} + z^{2}} \sqrt{x^{2} + y^{2}}} \right) \frac{\partial}{\partial x } + \left( \frac{y z}{\sqrt{x^{2} + y^{2} + z^{2}} \sqrt{x^{2} + y^{2}}} \right) \frac{\partial}{\partial y } + \left( -\frac{\sqrt{x^{2} + y^{2}}}{\sqrt{x^{2} + y^{2} + z^{2}}} \right) \frac{\partial}{\partial z }</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">es</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[18]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}e_3 = \left( -\frac{y}{\sqrt{x^{2} + y^{2}}} \right) \frac{\partial}{\partial x } + \left( \frac{x}{\sqrt{x^{2} + y^{2}}} \right) \frac{\partial}{\partial y }</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By construction, the change of frame $(\partial/\partial r, \partial/\partial \theta, \partial/\partial \phi) \rightarrow (e_1,e_2,e_3)$ is known. We form the change of frame  $(\partial/\partial x, \partial/\partial y, \partial/\partial z)\rightarrow (e_1,e_2,e_3)$ by composition of $(\partial/\partial x, \partial/\partial y, \partial/\partial z)\rightarrow (\partial/\partial r, \partial/\partial \theta, \partial/\partial \phi)$ with 
$(\partial/\partial r, \partial/\partial \theta, \partial/\partial \phi) \rightarrow (e_1,e_2,e_3)$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">M</span><span class="o">.</span><span class="n">set_change_of_frame</span><span class="p">(</span><span class="n">cart</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">es</span><span class="p">,</span> 
                      <span class="n">M</span><span class="o">.</span><span class="n">change_of_frame</span><span class="p">(</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">es</span><span class="p">)</span> <span class="o">*</span> <span class="n">M</span><span class="o">.</span><span class="n">change_of_frame</span><span class="p">(</span><span class="n">cart</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> 
                                                                               <span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">()),</span>
                      <span class="n">compute_inverse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">change_of_frame</span><span class="p">(</span><span class="n">cart</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">es</span><span class="p">)[:,</span> <span class="n">spher</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[19]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(\begin{array}{rrr}
\cos\left({\phi}\right) \sin\left({\theta}\right) & \cos\left({\phi}\right) \cos\left({\theta}\right) & -\sin\left({\phi}\right) \\
\sin\left({\phi}\right) \sin\left({\theta}\right) & \cos\left({\theta}\right) \sin\left({\phi}\right) & \cos\left({\phi}\right) \\
\cos\left({\theta}\right) & -\sin\left({\theta}\right) & 0
\end{array}\right)</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similarly, we form the inverse change of frame as:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">M</span><span class="o">.</span><span class="n">set_change_of_frame</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">cart</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> 
                      <span class="n">M</span><span class="o">.</span><span class="n">change_of_frame</span><span class="p">(</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">cart</span><span class="o">.</span><span class="n">frame</span><span class="p">())</span> <span class="o">*</span> 
                                  <span class="n">M</span><span class="o">.</span><span class="n">change_of_frame</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">()),</span>
                      <span class="n">compute_inverse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">change_of_frame</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">cart</span><span class="o">.</span><span class="n">frame</span><span class="p">())[:,</span> <span class="n">spher</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[20]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(\begin{array}{rrr}
\cos\left({\phi}\right) \sin\left({\theta}\right) & \sin\left({\phi}\right) \sin\left({\theta}\right) & \cos\left({\theta}\right) \\
\cos\left({\phi}\right) \cos\left({\theta}\right) & \cos\left({\theta}\right) \sin\left({\phi}\right) & -\sin\left({\theta}\right) \\
-\sin\left({\phi}\right) & \cos\left({\phi}\right) & 0
\end{array}\right)</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At this stage, the manifold (user) atlas is</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">M</span><span class="o">.</span><span class="n">atlas</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[21]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[\left(M,(x, y, z)\right), \left(M,(r, {\theta}, {\phi})\right)\right]</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The default chart is the first one introduced on the manifold (it can be changed by means of the function <code>M.set_default_chart</code>):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">M</span><span class="o">.</span><span class="n">default_chart</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[22]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(M,(x, y, z)\right)</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following vector frames have been introduced on the manifold:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">M</span><span class="o">.</span><span class="n">frames</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[23]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[\left(M, \left(\frac{\partial}{\partial x },\frac{\partial}{\partial y },\frac{\partial}{\partial z }\right)\right), \left(M, \left(\frac{\partial}{\partial r },\frac{\partial}{\partial {\theta} },\frac{\partial}{\partial {\phi} }\right)\right), \left(M, \left(e_1,e_2,e_3\right)\right)\right]</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The default frame is the first one introduced on the manifold (it can be changed by means of the function <code>M.set_default_frame</code>):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">M</span><span class="o">.</span><span class="n">default_frame</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[24]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(M, \left(\frac{\partial}{\partial x },\frac{\partial}{\partial y },\frac{\partial}{\partial z }\right)\right)</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following changes of frame have been defined:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">M</span><span class="o">.</span><span class="n">changes_of_frame</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[25]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left\{\left(\left(M, \left(\frac{\partial}{\partial x },\frac{\partial}{\partial y },\frac{\partial}{\partial z }\right)\right), \left(M, \left(\frac{\partial}{\partial r },\frac{\partial}{\partial {\theta} },\frac{\partial}{\partial {\phi} }\right)\right)\right) : \mbox{Field of tangent-space automorphisms on the 3-dimensional differentiable manifold M}, \left(\left(M, \left(e_1,e_2,e_3\right)\right), \left(M, \left(\frac{\partial}{\partial r },\frac{\partial}{\partial {\theta} },\frac{\partial}{\partial {\phi} }\right)\right)\right) : \mbox{Field of tangent-space automorphisms on the 3-dimensional differentiable manifold M}, \left(\left(M, \left(e_1,e_2,e_3\right)\right), \left(M, \left(\frac{\partial}{\partial x },\frac{\partial}{\partial y },\frac{\partial}{\partial z }\right)\right)\right) : \mbox{Field of tangent-space automorphisms on the 3-dimensional differentiable manifold M}, \left(\left(M, \left(\frac{\partial}{\partial x },\frac{\partial}{\partial y },\frac{\partial}{\partial z }\right)\right), \left(M, \left(e_1,e_2,e_3\right)\right)\right) : \mbox{Field of tangent-space automorphisms on the 3-dimensional differentiable manifold M}, \left(\left(M, \left(\frac{\partial}{\partial r },\frac{\partial}{\partial {\theta} },\frac{\partial}{\partial {\phi} }\right)\right), \left(M, \left(e_1,e_2,e_3\right)\right)\right) : \mbox{Field of tangent-space automorphisms on the 3-dimensional differentiable manifold M}, \left(\left(M, \left(\frac{\partial}{\partial r },\frac{\partial}{\partial {\theta} },\frac{\partial}{\partial {\phi} }\right)\right), \left(M, \left(\frac{\partial}{\partial x },\frac{\partial}{\partial y },\frac{\partial}{\partial z }\right)\right)\right) : \mbox{Field of tangent-space automorphisms on the 3-dimensional differentiable manifold M}\right\}</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Vector-field-defined-in-terms-of-its-Cartesian-components">Vector field defined in terms of its Cartesian components<a class="anchor-link" href="#Vector-field-defined-in-terms-of-its-Cartesian-components">&#182;</a></h2><p>We define the vector field $U$ in terms of its components with respect to the default frame, i.e. the Cartesian frame:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="n">U</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;U_x&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">),</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;U_y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">),</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;U_z&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)]</span>
<span class="n">U</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[26]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}U = U_{x}\left(x, y, z\right) \frac{\partial}{\partial x } + U_{y}\left(x, y, z\right) \frac{\partial}{\partial y } + U_{z}\left(x, y, z\right) \frac{\partial}{\partial z }</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can ask for its components in terms of the spherical orthonormal frame:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">U</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">es</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[27]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}U = \left( \frac{x U_{x}\left(x, y, z\right) + y U_{y}\left(x, y, z\right) + z U_{z}\left(x, y, z\right)}{\sqrt{x^{2} + y^{2} + z^{2}}} \right) e_1 + \left( -\frac{x^{2} U_{z}\left(x, y, z\right) + y^{2} U_{z}\left(x, y, z\right) - {\left(x U_{x}\left(x, y, z\right) + y U_{y}\left(x, y, z\right)\right)} z}{\sqrt{x^{2} + y^{2} + z^{2}} \sqrt{x^{2} + y^{2}}} \right) e_2 + \left( -\frac{y U_{x}\left(x, y, z\right) - x U_{y}\left(x, y, z\right)}{\sqrt{x^{2} + y^{2}}} \right) e_3</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">U</span><span class="o">.</span><span class="n">display_comp</span><span class="p">(</span><span class="n">es</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[28]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\begin{array}{lcl} U_{\phantom{\, 1}}^{\,1} & = & \frac{x U_{x}\left(x, y, z\right) + y U_{y}\left(x, y, z\right) + z U_{z}\left(x, y, z\right)}{\sqrt{x^{2} + y^{2} + z^{2}}} \\ U_{\phantom{\, 2}}^{\,2} & = & -\frac{x^{2} U_{z}\left(x, y, z\right) + y^{2} U_{z}\left(x, y, z\right) - {\left(x U_{x}\left(x, y, z\right) + y U_{y}\left(x, y, z\right)\right)} z}{\sqrt{x^{2} + y^{2} + z^{2}} \sqrt{x^{2} + y^{2}}} \\ U_{\phantom{\, 3}}^{\,3} & = & -\frac{y U_{x}\left(x, y, z\right) - x U_{y}\left(x, y, z\right)}{\sqrt{x^{2} + y^{2}}} \end{array}</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above components are displayed in terms of the default chart (Cartesian coordinates). If we want them in terms of spherical coordinates, we have to specify it, by setting the second argument of the function <code>display</code> to <code>spher</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">U</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[29]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}U = \left( U_{x}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\phi}\right) \sin\left({\theta}\right) + U_{y}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \sin\left({\phi}\right) \sin\left({\theta}\right) + U_{z}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\theta}\right) \right) e_1 + \left( U_{x}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\phi}\right) \cos\left({\theta}\right) + U_{y}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\theta}\right) \sin\left({\phi}\right) - U_{z}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \sin\left({\theta}\right) \right) e_2 + \left( U_{y}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\phi}\right) - U_{x}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \sin\left({\phi}\right) \right) e_3</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">U</span><span class="o">.</span><span class="n">display_comp</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[30]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\begin{array}{lcl} U_{\phantom{\, 1}}^{\,1} & = & U_{x}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\phi}\right) \sin\left({\theta}\right) + U_{y}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \sin\left({\phi}\right) \sin\left({\theta}\right) + U_{z}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\theta}\right) \\ U_{\phantom{\, 2}}^{\,2} & = & U_{x}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\phi}\right) \cos\left({\theta}\right) + U_{y}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\theta}\right) \sin\left({\phi}\right) - U_{z}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \sin\left({\theta}\right) \\ U_{\phantom{\, 3}}^{\,3} & = & U_{y}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\phi}\right) - U_{x}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \sin\left({\phi}\right) \end{array}</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We may also ask for the components of $U$ w.r.t. the natural frame of spherical coordinates:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">U</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[31]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}U = \left( \frac{x U_{x}\left(x, y, z\right) + y U_{y}\left(x, y, z\right) + z U_{z}\left(x, y, z\right)}{\sqrt{x^{2} + y^{2} + z^{2}}} \right) \frac{\partial}{\partial r } + \left( -\frac{{\left(x^{2} U_{z}\left(x, y, z\right) + y^{2} U_{z}\left(x, y, z\right) - {\left(x U_{x}\left(x, y, z\right) + y U_{y}\left(x, y, z\right)\right)} z\right)} \sqrt{x^{2} + y^{2}}}{x^{4} + 2 \, x^{2} y^{2} + y^{4} + {\left(x^{2} + y^{2}\right)} z^{2}} \right) \frac{\partial}{\partial {\theta} } + \left( -\frac{y U_{x}\left(x, y, z\right) - x U_{y}\left(x, y, z\right)}{x^{2} + y^{2}} \right) \frac{\partial}{\partial {\phi} }</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">U</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[32]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}U = \left( U_{x}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\phi}\right) \sin\left({\theta}\right) + U_{y}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \sin\left({\phi}\right) \sin\left({\theta}\right) + U_{z}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\theta}\right) \right) \frac{\partial}{\partial r } + \left( \frac{U_{x}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\phi}\right) \cos\left({\theta}\right) + U_{y}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\theta}\right) \sin\left({\phi}\right) - U_{z}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \sin\left({\theta}\right)}{r} \right) \frac{\partial}{\partial {\theta} } + \left( \frac{U_{y}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \cos\left({\phi}\right) - U_{x}\left(r \cos\left({\phi}\right) \sin\left({\theta}\right), r \sin\left({\phi}\right) \sin\left({\theta}\right), r \cos\left({\theta}\right)\right) \sin\left({\phi}\right)}{r \sin\left({\theta}\right)} \right) \frac{\partial}{\partial {\phi} }</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Vector-field-defined-in-terms-of-its-spherical-components">Vector field defined in terms of its spherical components<a class="anchor-link" href="#Vector-field-defined-in-terms-of-its-spherical-components">&#182;</a></h2><p>Let us consider a vector field $V$ defined by its components with respect to the orthonormal spherical frame <code>es</code> = $(e_1, e_2, e_3)$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">V</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="n">V</span><span class="p">[</span><span class="n">es</span><span class="p">,:,</span><span class="n">spher</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;V_1&#39;</span><span class="p">)(</span><span class="n">r</span><span class="p">,</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="p">),</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;V_2&#39;</span><span class="p">)(</span><span class="n">r</span><span class="p">,</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="p">),</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;V_3&#39;</span><span class="p">)(</span><span class="n">r</span><span class="p">,</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="p">)]</span>
<span class="n">V</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[33]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}V = V_{1}\left(r, {\theta}, {\phi}\right) e_1 + V_{2}\left(r, {\theta}, {\phi}\right) e_2 + V_{3}\left(r, {\theta}, {\phi}\right) e_3</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We may ask for the components of this vector field with respect to the Cartesian frame (first argument <code>cart.frame()</code>), each component being expressed in terms of spherical coordinates (second argument <code>spher</code>):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">V</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">cart</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[34]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}V = \left( V_{2}\left(r, {\theta}, {\phi}\right) \cos\left({\phi}\right) \cos\left({\theta}\right) + V_{1}\left(r, {\theta}, {\phi}\right) \cos\left({\phi}\right) \sin\left({\theta}\right) - V_{3}\left(r, {\theta}, {\phi}\right) \sin\left({\phi}\right) \right) \frac{\partial}{\partial x } + \left( V_{2}\left(r, {\theta}, {\phi}\right) \cos\left({\theta}\right) \sin\left({\phi}\right) + V_{1}\left(r, {\theta}, {\phi}\right) \sin\left({\phi}\right) \sin\left({\theta}\right) + V_{3}\left(r, {\theta}, {\phi}\right) \cos\left({\phi}\right) \right) \frac{\partial}{\partial y } + \left( V_{1}\left(r, {\theta}, {\phi}\right) \cos\left({\theta}\right) - V_{2}\left(r, {\theta}, {\phi}\right) \sin\left({\theta}\right) \right) \frac{\partial}{\partial z }</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">V</span><span class="o">.</span><span class="n">display_comp</span><span class="p">(</span><span class="n">cart</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[35]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\begin{array}{lcl} V_{\phantom{\, x}}^{ \, x } & = & V_{2}\left(r, {\theta}, {\phi}\right) \cos\left({\phi}\right) \cos\left({\theta}\right) + V_{1}\left(r, {\theta}, {\phi}\right) \cos\left({\phi}\right) \sin\left({\theta}\right) - V_{3}\left(r, {\theta}, {\phi}\right) \sin\left({\phi}\right) \\ V_{\phantom{\, y}}^{ \, y } & = & V_{2}\left(r, {\theta}, {\phi}\right) \cos\left({\theta}\right) \sin\left({\phi}\right) + V_{1}\left(r, {\theta}, {\phi}\right) \sin\left({\phi}\right) \sin\left({\theta}\right) + V_{3}\left(r, {\theta}, {\phi}\right) \cos\left({\phi}\right) \\ V_{\phantom{\, z}}^{ \, z } & = & V_{1}\left(r, {\theta}, {\phi}\right) \cos\left({\theta}\right) - V_{2}\left(r, {\theta}, {\phi}\right) \sin\left({\theta}\right) \end{array}</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Euclidean-metric">Euclidean metric<a class="anchor-link" href="#Euclidean-metric">&#182;</a></h2><p>The standard Euclidean metric is introduced as a Riemannian metric on $M$, whose components with respect to the Cartesian frame are $\mathrm{diag}(1,1,1)$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">riemannian_metric</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[36]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}g = \mathrm{d} x\otimes \mathrm{d} x+\mathrm{d} y\otimes \mathrm{d} y+\mathrm{d} z\otimes \mathrm{d} z</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The components of $g$ with respect to the spherical coordinates are then:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[37]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}g = \mathrm{d} r\otimes \mathrm{d} r + r^{2} \mathrm{d} {\theta}\otimes \mathrm{d} {\theta} + r^{2} \sin\left({\theta}\right)^{2} \mathrm{d} {\phi}\otimes \mathrm{d} {\phi}</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since <code>es</code> = $(e_1,e_2,e_3)$ is an orthonormal frame, the components of $g$ with respect to it are $\mathrm{diag}(1,1,1)$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[38]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}g = e^1\otimes e^1+e^2\otimes e^2+e^3\otimes e^3</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The covariant derivative operator $\nabla$ is introduced as the (Levi-Civita) connection associated with $g$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">nabla</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">connection</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">nabla</span><span class="p">)</span>
<span class="n">nabla</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>Levi-Civita connection nabla_g associated with the Riemannian metric g on the 3-dimensional differentiable manifold M
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[39]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\nabla_{g}</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The connection coefficient with respect to the natural frame of spherical coordinates (Christoffel symbols) are:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">nabla</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">spher</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[40]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\begin{array}{lcl} \Gamma_{ \phantom{\, r} \, {\theta} \, {\theta} }^{ \, r \phantom{\, {\theta}} \phantom{\, {\theta}} } & = & -r \\ \Gamma_{ \phantom{\, r} \, {\phi} \, {\phi} }^{ \, r \phantom{\, {\phi}} \phantom{\, {\phi}} } & = & -r \sin\left({\theta}\right)^{2} \\ \Gamma_{ \phantom{\, {\theta}} \, r \, {\theta} }^{ \, {\theta} \phantom{\, r} \phantom{\, {\theta}} } & = & \frac{1}{r} \\ \Gamma_{ \phantom{\, {\theta}} \, {\theta} \, r }^{ \, {\theta} \phantom{\, {\theta}} \phantom{\, r} } & = & \frac{1}{r} \\ \Gamma_{ \phantom{\, {\theta}} \, {\phi} \, {\phi} }^{ \, {\theta} \phantom{\, {\phi}} \phantom{\, {\phi}} } & = & -\cos\left({\theta}\right) \sin\left({\theta}\right) \\ \Gamma_{ \phantom{\, {\phi}} \, r \, {\phi} }^{ \, {\phi} \phantom{\, r} \phantom{\, {\phi}} } & = & \frac{1}{r} \\ \Gamma_{ \phantom{\, {\phi}} \, {\theta} \, {\phi} }^{ \, {\phi} \phantom{\, {\theta}} \phantom{\, {\phi}} } & = & \frac{\cos\left({\theta}\right)}{\sin\left({\theta}\right)} \\ \Gamma_{ \phantom{\, {\phi}} \, {\phi} \, r }^{ \, {\phi} \phantom{\, {\phi}} \phantom{\, r} } & = & \frac{1}{r} \\ \Gamma_{ \phantom{\, {\phi}} \, {\phi} \, {\theta} }^{ \, {\phi} \phantom{\, {\phi}} \phantom{\, {\theta}} } & = & \frac{\cos\left({\theta}\right)}{\sin\left({\theta}\right)} \end{array}</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>while those with respect to the orthonormal spherical frame are:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">nabla</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[41]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\begin{array}{lcl} \Gamma_{\phantom{\, 1}\,2\,2}^{\,1\phantom{\, 2}\phantom{\, 2}} & = & -\frac{1}{r} \\ \Gamma_{\phantom{\, 1}\,3\,3}^{\,1\phantom{\, 3}\phantom{\, 3}} & = & -\frac{1}{r} \\ \Gamma_{\phantom{\, 2}\,1\,2}^{\,2\phantom{\, 1}\phantom{\, 2}} & = & \frac{1}{r} \\ \Gamma_{\phantom{\, 2}\,3\,3}^{\,2\phantom{\, 3}\phantom{\, 3}} & = & -\frac{\cos\left({\theta}\right)}{r \sin\left({\theta}\right)} \\ \Gamma_{\phantom{\, 3}\,1\,3}^{\,3\phantom{\, 1}\phantom{\, 3}} & = & \frac{1}{r} \\ \Gamma_{\phantom{\, 3}\,2\,3}^{\,3\phantom{\, 2}\phantom{\, 3}} & = & \frac{\cos\left({\theta}\right)}{r \sin\left({\theta}\right)} \end{array}</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The covariant derivative of $U$ is</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">nabU</span> <span class="o">=</span> <span class="n">nabla</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">nabU</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>Tensor field nabla_g(U) of type (1,1) on the 3-dimensional differentiable manifold M
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">nabU</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[43]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\nabla_{g} U = \frac{\partial\,U_{x}}{\partial x} \frac{\partial}{\partial x }\otimes \mathrm{d} x + \frac{\partial\,U_{x}}{\partial y} \frac{\partial}{\partial x }\otimes \mathrm{d} y + \frac{\partial\,U_{x}}{\partial z} \frac{\partial}{\partial x }\otimes \mathrm{d} z + \frac{\partial\,U_{y}}{\partial x} \frac{\partial}{\partial y }\otimes \mathrm{d} x + \frac{\partial\,U_{y}}{\partial y} \frac{\partial}{\partial y }\otimes \mathrm{d} y + \frac{\partial\,U_{y}}{\partial z} \frac{\partial}{\partial y }\otimes \mathrm{d} z + \frac{\partial\,U_{z}}{\partial x} \frac{\partial}{\partial z }\otimes \mathrm{d} x + \frac{\partial\,U_{z}}{\partial y} \frac{\partial}{\partial z }\otimes \mathrm{d} y + \frac{\partial\,U_{z}}{\partial z} \frac{\partial}{\partial z }\otimes \mathrm{d} z</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>while the covariant derivative of $V$ is</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">nabV</span> <span class="o">=</span> <span class="n">nabla</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">nabV</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>Tensor field nabla_g(V) of type (1,1) on the 3-dimensional differentiable manifold M
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">nabV</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">spher</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[45]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\nabla_{g} V = \frac{\partial\,V_{1}}{\partial r} e_1\otimes e^1 + \left( -\frac{V_{2}\left(r, {\theta}, {\phi}\right) - \frac{\partial\,V_{1}}{\partial {\theta}}}{r} \right) e_1\otimes e^2 + \left( -\frac{V_{3}\left(r, {\theta}, {\phi}\right) \sin\left({\theta}\right) - \frac{\partial\,V_{1}}{\partial {\phi}}}{r \sin\left({\theta}\right)} \right) e_1\otimes e^3 + \frac{\partial\,V_{2}}{\partial r} e_2\otimes e^1 + \left( \frac{V_{1}\left(r, {\theta}, {\phi}\right) + \frac{\partial\,V_{2}}{\partial {\theta}}}{r} \right) e_2\otimes e^2 + \left( -\frac{V_{3}\left(r, {\theta}, {\phi}\right) \cos\left({\theta}\right) - \frac{\partial\,V_{2}}{\partial {\phi}}}{r \sin\left({\theta}\right)} \right) e_2\otimes e^3 + \frac{\partial\,V_{3}}{\partial r} e_3\otimes e^1 + \frac{\frac{\partial\,V_{3}}{\partial {\theta}}}{r} e_3\otimes e^2 + \left( \frac{V_{2}\left(r, {\theta}, {\phi}\right) \cos\left({\theta}\right) + V_{1}\left(r, {\theta}, {\phi}\right) \sin\left({\theta}\right) + \frac{\partial\,V_{3}}{\partial {\phi}}}{r \sin\left({\theta}\right)} \right) e_3\otimes e^3</script></html>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span> 
</pre></div>

</div>
</div>
</div>

</div>
 


    </div>
  </div>

  </div>


  
    <footer class="footer hidden-print">
      <div class="container">
        <div class="col-md-4">
          <p>
            This website does not host notebooks, it only renders notebooks
            available on other websites.
          </p>
        </div>

        <div class="col-md-4">
          <p>
            Delivered by <a href="http://www.fastly.com/">Fastly</a>,
            Rendered by <a href="https://developer.rackspace.com/?nbviewer=awesome">Rackspace</a>
          </p>
          <p>
            nbviewer GitHub <a href="https://github.com/jupyter/nbviewer">repository</a>.
          </p>
        </div>

        <div class="col-md-4">
          
  
            
              <p>
                nbviewer version:
                <a href="https://github.com/jupyter/nbviewer/commit/4f5d1d8a2539c1c8dc92873d3a775d34f0a3d417">
                  4f5d1d8
                </a>
              </p>
            
          
  
  <p>
    nbconvert version: <a href="https://github.com/jupyter/nbconvert/releases/tag/5.1.1">
      5.1.1
    </a>
  </p>
  

          
  
  
  <p>
    Rendered
    <span class='date' data-date='Fri, 07 Apr 2017 17:49:29 UTC' title='Fri, 07 Apr 2017 17:49:29 UTC'>(Fri, 07 Apr 2017 17:49:29 UTC)</span>
  </p>
  

        </div>
      </div>
    </footer>
  

  <script src="https://unpkg.com/jupyter-js-widgets@2.0.*/dist/embed.js"></script>
  <script src="/static/components/bootstrap/js/bootstrap.min.js?v=5869c96cc8f19086aee625d670d741f9"></script>
  <script src="/static/components/headroom.js/dist/headroom.min.js?v=b0a311ea668f8e768ea375f4a7abb81c"></script>
  <script src="/static/components/headroom.js/dist/jQuery.headroom.min.js?v=f3a1bae118315d0c234afc74dc6aab71"></script>

  
  
  <script>
    $(function(){ $("#menubar").headroom({
      tolerance: 5,
      offset: 205,
      classes: {
        initial: "animated",
        pinned: "slideInDown",
        unpinned: "slideOutUp"
      }
    })});
  </script>


  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-52617120-5', 'auto');
    ga('send', 'pageview');
  </script>
  
  <script>
    require({
        paths: {
          moment: "/static/components/moment/min/moment.min.js?v=89f87298ad94aa1e6b92f42eb66da043"
        }
      }, ["moment"], function(moment){
      var date = $("footer .date"),
        m = moment(new Date(date.data('date'))),
        update = function(){ date.text(m.fromNow()); };
      setInterval(update, 61*1000);
      update();
      var w = $(window).scroll(function(event){
        $("body").toggleClass("scrolled", w.scrollTop() > 0);
      });
    });
  </script>
  <!--NEW RELIC Stop Perf Measurement-->
  
  <!--NEW RELIC End-->
</body>
</html>